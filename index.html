<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì¹´ì¹´ì˜¤í†¡ ì´ëª¨í‹°ì½˜ ì„¤ë¬¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    * {
      box-sizing: border-box;
      font-family: "Noto Sans KR", system-ui, -apple-system, BlinkMacSystemFont,
        "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px 12px;
      background: radial-gradient(circle at top, #ffe4f1 0, #f4f7ff 40%, #e5edff 100%);
    }

    .page-shell {
      width: 100%;
      max-width: 980px;
      display: flex;
      justify-content: center;
    }

    .survey-card {
      width: 100%;
      background: #ffffff;
      border-radius: 28px;
      padding: 26px 26px 30px;
      box-shadow: 0 18px 45px rgba(31, 41, 55, 0.16);
      border: 1px solid rgba(148, 163, 255, 0.55);
      position: relative;
    }

    header {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 18px;
    }

    .title-area { flex: 1; }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 11px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4f46e5;
      font-size: 0.72rem;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .badge-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #4f46e5;
    }

    h1 {
      margin: 0 0 4px;
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
    }

    .subtitle {
      font-size: 0.9rem;
      color: #6b7280;
      line-height: 1.55;
    }

    hr {
      border: none;
      border-top: 1px solid #e5e7eb;
      margin: 18px 0 20px;
    }

    .session-title {
      margin: 20px 0 8px;
      font-size: 1.05rem;
      font-weight: 700;
      color: #1f2933;
    }

    .session-subtitle {
      font-size: 0.82rem;
      color: #6b7280;
      margin-bottom: 10px;
    }

    .step { display: none; }
    .step-active { display: block; }

    .sticky-emoji-wrapper {
      position: sticky;
      top: 10px;
      z-index: 20;
      padding-bottom: 14px;
      background: linear-gradient(to bottom, #ffffff 70%, rgba(255,255,255,0));
      margin-bottom: 10px;
    }

    .emoji-top-box {
      width: 150px;
      height: 150px;
      margin: 0 auto;
      background: #ffffff;
      border: 1px solid rgba(209, 213, 245, 0.9);
      border-radius: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      box-shadow: 0 6px 14px rgba(148, 163, 255, 0.18);
    }

    .emoji-top-box img { width: 86%; height: auto; display: block; }

    .emoji-inline {
      display: flex;
      justify-content: center;
      margin-bottom: 8px;
    }

    .emoji-inline img { width: 80px; height: auto; }

    .emoji-block { margin-bottom: 26px; }

    .question-block {
      padding: 16px 18px 18px;
      border-radius: 22px;
      background: linear-gradient(145deg, rgba(238, 242, 255, 0.9), rgba(248, 250, 252, 0.95));
      border: 1px solid rgba(209, 213, 245, 0.9);
      margin-bottom: 14px;
      box-shadow: 0 6px 16px rgba(148, 163, 255, 0.18);
    }

    .question-block.white {
      background: #ffffff;
      box-shadow: 0 4px 10px rgba(148, 163, 255, 0.15);
    }

    .question-title {
      font-size: 0.97rem;
      font-weight: 600;
      color: #111827;
      margin-bottom: 4px;
    }

    .question-desc {
      font-size: 0.8rem;
      color: #6b7280;
      margin-bottom: 10px;
    }

    input[type="text"], input[type="number"] {
      width: 100%;
      padding: 9px 10px;
      font-size: 0.9rem;
      border-radius: 12px;
      border: 1px solid #d4d7f0;
      outline: none;
      background: #ffffff;
    }
    input[type="text"]:focus, input[type="number"]:focus {
      border-color: #4f46e5;
      box-shadow: 0 0 0 1px rgba(79, 70, 229, 0.1);
    }

    textarea {
      width: 100%;
      min-height: 72px;
      padding: 9px 10px;
      font-size: 0.9rem;
      border-radius: 12px;
      border: 1px solid #d4d7f0;
      resize: vertical;
      outline: none;
      background: #ffffff;
    }
    textarea:focus {
      border-color: #4f46e5;
      box-shadow: 0 0 0 1px rgba(79, 70, 229, 0.1);
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 2px;
    }

    .option {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 7px 10px;
      border-radius: 999px;
      background: rgba(243, 244, 255, 0.85);
      border: 1px solid transparent;
      font-size: 0.88rem;
      color: #111827;
      cursor: pointer;
      max-width: 100%;
    }

    .option input { accent-color: #4f46e5; }

    .option:hover {
      border-color: #c7d2fe;
      background: #eef2ff;
    }

    .likert-row {
      display: flex;
      justify-content: space-between;
      gap: 4px;
      margin-top: 4px;
      flex-wrap: nowrap;
    }

    .likert-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      font-size: 0.75rem;
      color: #6b7280;
      cursor: pointer;
    }

    .likert-item input { display: none; }

    .likert-number { font-size: 0.72rem; }

    .emotion-dot {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      border: 1px solid #c7d2fe;
      background: #ffffff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.15s ease-out;
      position: relative;
    }

    .emotion-dot::before {
      content: "";
      width: 9px;
      height: 9px;
      border-radius: 999px;
      border: 2px solid transparent;
      transition: all 0.15s ease-out;
    }

    input[type="radio"]:checked + .emotion-dot {
      background: radial-gradient(circle at 30% 0, #f9a8d4 0, #6366f1 45%, #4f46e5 100%);
      border-color: transparent;
      box-shadow: 0 0 0 3px rgba(129, 140, 248, 0.5);
      transform: translateY(-1px);
    }

    input[type="radio"]:checked + .emotion-dot::before { background: #ffffff; }

    .emotion-dot:hover {
      border-color: #818cf8;
      transform: translateY(-1px);
    }

    .emotion-table { width: 100%; border-collapse: collapse; margin-top: 10px; }

    .emotion-row {
      display: grid;
      grid-template-columns: 80px repeat(8, 1fr);
      align-items: center;
      padding: 6px 4px;
    }

    .emotion-row:nth-child(even) { background: rgba(238, 242, 255, 0.6); }

    .emotion-label {
      font-size: 0.9rem;
      color: #374151;
      font-weight: 500;
    }

    .row-center {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .row-center input { display: none; }

    .buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
      gap: 8px;
    }

    .buttons-right { justify-content: flex-end; }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 9px 18px;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
    }

    .btn-secondary { background: #e5e7eb; color: #374151; }

    .btn-primary {
      background: linear-gradient(135deg, #4f46e5, #ec4899);
      color: #ffffff;
      box-shadow: 0 12px 24px rgba(79, 70, 229, 0.45);
    }

    .btn-primary:hover { filter: brightness(1.05); transform: translateY(-1px); }

    .error-toast {
      display: none; /* í•„ìˆ˜ ê²€ì¦ ì œê±°í–ˆìœ¼ë‹ˆ ì‚¬ìš© ì•ˆ í•¨ */
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(254, 226, 226, 0.85);
      border: 1px solid rgba(239, 68, 68, 0.35);
      color: #991b1b;
      font-size: 0.86rem;
      line-height: 1.35;
    }

    #thank-you {
      text-align: center;
      padding: 40px 8px 24px;
      display: none;
    }

    #thank-you h2 { margin: 0 0 10px; font-size: 1.3rem; }
    #thank-you p { font-size: 0.9rem; color: #6b7280; line-height: 1.6; }

    @media (max-width: 768px) {
      body { padding: 18px 10px; }
      .survey-card { padding: 20px 16px 22px; border-radius: 22px; }
      h1 { font-size: 1.3rem; }
      .subtitle { font-size: 0.86rem; }
      .emoji-top-box { width: 120px; height: 120px; }
      .emotion-dot { width: 20px; height: 20px; }
    }

    @media (max-width: 480px) {
      .survey-card { padding: 18px 12px 20px; }
      h1 { font-size: 1.15rem; }
    }
  </style>
</head>

<body>
  <div class="page-shell">
    <div class="survey-card">

      <header>
        <div class="title-area">
          <div class="badge">
            <span class="badge-dot"></span>
            <span>KakaoTalk Â· Emoji Study</span>
          </div>
          <h1>ì¹´ì¹´ì˜¤ ì´ëª¨í‹°ì½˜ ì‚¬ìš© ë° ê°ì • íŒë‹¨ ì„¤ë¬¸</h1>
          <p class="subtitle">
            ì´ ì„¤ë¬¸ì€ ì¹´ì¹´ì˜¤ ì´ëª¨í‹°ì½˜ ì‚¬ìš© ê²½í—˜ê³¼ ì´ëª¨í‹°ì½˜ì´ í‘œí˜„í•˜ëŠ” ê°ì •ì— ëŒ€í•œ íŒë‹¨ì„ ì¡°ì‚¬í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.<br />
            (ëª¨ë“  ë¬¸í•­ì€ ì„ íƒ ì‘ë‹µì…ë‹ˆë‹¤.)
          </p>
        </div>
      </header>

      <hr />

      <form id="survey-form">
        <!-- ======================================================
             [PAGE 1] STEP1 - PART A + PART B
        ======================================================= -->
        <section id="step1" class="step step-active">
          <div class="session-title">PAGE 1. ì¸êµ¬í†µê³„ ì •ë³´ & ì¹´ì¹´ì˜¤í†¡ ì‚¬ìš© ê²½í—˜</div>
          <div class="session-subtitle">PART A, PART Bì— ë‹µí•´ì£¼ì„¸ìš”.</div>

          <div class="session-title" style="margin-top:10px;">PART A. ì¸êµ¬í†µê³„í•™ì  ì •ë³´</div>

          <div class="question-block">
            <div class="question-title">A1. ì´ë¦„</div>
            <div class="question-desc">ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
            <input type="text" name="A1_name" />
          </div>

          <div class="question-block">
            <div class="question-title">A2. ì—°ë ¹(ë§Œ)</div>
            <div class="question-desc">ìˆ«ì ì…ë ¥ (10â€“120)</div>
            <input type="number" name="A2_age" min="10" max="120" />
          </div>

          <div class="question-block">
            <div class="question-title">A3. ì„±ë³„</div>
            <div class="options">
              <label class="option"><input type="radio" name="A3_gender" value="ë‚¨ì„±" /> <span>ë‚¨ì„±</span></label>
              <label class="option"><input type="radio" name="A3_gender" value="ì—¬ì„±" /> <span>ì—¬ì„±</span></label>
            </div>
          </div>

          <div class="question-block">
            <div class="question-title">A4. êµ­ì </div>
            <input type="text" name="A4_nationality" />
          </div>

          <div class="question-block">
            <div class="question-title">A5. í˜„ì¬ ê±°ì£¼ êµ­ê°€</div>
            <input type="text" name="A5_country" />
          </div>

          <div class="question-block">
            <div class="question-title">A6. ëª¨êµ­ì–´(L1)</div>
            <input type="text" name="A6_L1" />
          </div>

          <div class="question-block">
            <div class="question-title">A7. ì œ2ì™¸êµ­ì–´(ìµœëŒ€ 3ê°œ) (ì„ íƒ)</div>
            <div class="question-desc">
              ê° ìˆœìœ„ë§ˆë‹¤ ì–¸ì–´ëª… + ìˆ˜ì¤€ì„ ì…ë ¥/ì„ íƒí•´ì£¼ì„¸ìš”. (í•´ë‹¹ ì—†ìœ¼ë©´ ë¹„ì›Œë‘ì…”ë„ ë©ë‹ˆë‹¤)
            </div>

            <div class="question-desc" style="margin-top:8px;">1ìˆœìœ„</div>
            <input type="text" name="A7_L2_1_lang" placeholder="ì˜ˆ: ì˜ì–´" />
            <div class="options" style="margin-top:8px;">
              <label class="option"><input type="radio" name="A7_L2_1_level" value="ê¸°ì´ˆ" /> <span>ê¸°ì´ˆ</span></label>
              <label class="option"><input type="radio" name="A7_L2_1_level" value="ì¤‘ê¸‰" /> <span>ì¤‘ê¸‰</span></label>
              <label class="option"><input type="radio" name="A7_L2_1_level" value="ê³ ê¸‰" /> <span>ê³ ê¸‰</span></label>
              <label class="option"><input type="radio" name="A7_L2_1_level" value="ì›ì–´ë¯¼ ìˆ˜ì¤€" /> <span>ì›ì–´ë¯¼ ìˆ˜ì¤€</span></label>
            </div>

            <div class="question-desc" style="margin-top:12px;">2ìˆœìœ„</div>
            <input type="text" name="A7_L2_2_lang" placeholder="ì˜ˆ: ì¼ë³¸ì–´" />
            <div class="options" style="margin-top:8px;">
              <label class="option"><input type="radio" name="A7_L2_2_level" value="ê¸°ì´ˆ" /> <span>ê¸°ì´ˆ</span></label>
              <label class="option"><input type="radio" name="A7_L2_2_level" value="ì¤‘ê¸‰" /> <span>ì¤‘ê¸‰</span></label>
              <label class="option"><input type="radio" name="A7_L2_2_level" value="ê³ ê¸‰" /> <span>ê³ ê¸‰</span></label>
              <label class="option"><input type="radio" name="A7_L2_2_level" value="ì›ì–´ë¯¼ ìˆ˜ì¤€" /> <span>ì›ì–´ë¯¼ ìˆ˜ì¤€</span></label>
            </div>

            <div class="question-desc" style="margin-top:12px;">3ìˆœìœ„</div>
            <input type="text" name="A7_L2_3_lang" placeholder="ì˜ˆ: ì¤‘êµ­ì–´" />
            <div class="options" style="margin-top:8px;">
              <label class="option"><input type="radio" name="A7_L2_3_level" value="ê¸°ì´ˆ" /> <span>ê¸°ì´ˆ</span></label>
              <label class="option"><input type="radio" name="A7_L2_3_level" value="ì¤‘ê¸‰" /> <span>ì¤‘ê¸‰</span></label>
              <label class="option"><input type="radio" name="A7_L2_3_level" value="ê³ ê¸‰" /> <span>ê³ ê¸‰</span></label>
              <label class="option"><input type="radio" name="A7_L2_3_level" value="ì›ì–´ë¯¼ ìˆ˜ì¤€" /> <span>ì›ì–´ë¯¼ ìˆ˜ì¤€</span></label>
            </div>
          </div>

          <div class="question-block">
            <div class="question-title">A8. í•´ì™¸ ì²´ë¥˜ ê²½í—˜(ì—¬í–‰ ì œì™¸, 6ê°œì›” ì´ìƒ) (ì„ íƒ)</div>
            <div class="options">
              <label class="option"><input type="radio" name="A8_overseas" value="ì—†ìŒ" /> <span>ì—†ìŒ</span></label>
              <label class="option"><input type="radio" name="A8_overseas" value="1íšŒ" /> <span>1íšŒ</span></label>
              <label class="option"><input type="radio" name="A8_overseas" value="2íšŒ ì´ìƒ" /> <span>2íšŒ ì´ìƒ</span></label>
            </div>
            <div class="question-desc" style="margin-top:10px;">(ì„ íƒ) êµ­ê°€/ê¸°ê°„ ì„œìˆ : ì˜ˆ) â€œë…ì¼ 1ë…„ 2ê°œì›” / ë¯¸êµ­ 8ê°œì›”â€</div>
            <textarea name="A8_overseas_detail" placeholder="ì˜ˆ: ë…ì¼ 1ë…„ 2ê°œì›” / ë¯¸êµ­ 8ê°œì›”"></textarea>
          </div>

          <div class="session-title" style="margin-top:18px;">PART B. ì¹´ì¹´ì˜¤í†¡ ì‚¬ìš© ê²½í—˜</div>

          <div class="question-block">
            <div class="question-title">B1. ì¹´ì¹´ì˜¤í†¡ ì‚¬ìš© ê¸°ê°„</div>
            <div class="options">
              <label class="option"><input type="radio" name="B1_kakao_period" value="3ê°œì›” ë¯¸ë§Œ(1)" /><span>3ê°œì›” ë¯¸ë§Œ(1)</span></label>
              <label class="option"><input type="radio" name="B1_kakao_period" value="3~6ê°œì›”(2)" /><span>3~6ê°œì›”(2)</span></label>
              <label class="option"><input type="radio" name="B1_kakao_period" value="6ê°œì›”~1ë…„(3)" /><span>6ê°œì›”~1ë…„(3)</span></label>
              <label class="option"><input type="radio" name="B1_kakao_period" value="1~2ë…„(4)" /><span>1~2ë…„(4)</span></label>
              <label class="option"><input type="radio" name="B1_kakao_period" value="2ë…„ ì´ìƒ(5)" /><span>2ë…„ ì´ìƒ(5)</span></label>
            </div>
          </div>

          <div class="question-block">
            <div class="question-title">B2. í•˜ë£¨ í‰ê·  ì¹´ì¹´ì˜¤í†¡ ì‚¬ìš© ì‹œê°„</div>
            <div class="options">
              <label class="option"><input type="radio" name="B2_kakao_time" value="30ë¶„ ë¯¸ë§Œ(1)" /><span>30ë¶„ ë¯¸ë§Œ(1)</span></label>
              <label class="option"><input type="radio" name="B2_kakao_time" value="30ë¶„~1ì‹œê°„(2)" /><span>30ë¶„~1ì‹œê°„(2)</span></label>
              <label class="option"><input type="radio" name="B2_kakao_time" value="1~2ì‹œê°„(3)" /><span>1~2ì‹œê°„(3)</span></label>
              <label class="option"><input type="radio" name="B2_kakao_time" value="2~3ì‹œê°„(4)" /><span>2~3ì‹œê°„(4)</span></label>
              <label class="option"><input type="radio" name="B2_kakao_time" value="3ì‹œê°„ ì´ìƒ(5)" /><span>3ì‹œê°„ ì´ìƒ(5)</span></label>
            </div>
          </div>

          <div class="question-block">
            <div class="question-title">B3. ì¹´ì¹´ì˜¤í†¡ ëŒ€í™” ì¤‘ ì´ëª¨í‹°ì½˜ ì‚¬ìš© ë¹ˆë„</div>
            <div class="options">
              <label class="option"><input type="radio" name="B3_emoji_freq" value="ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ(1)" /><span>ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ(1)</span></label>
              <label class="option"><input type="radio" name="B3_emoji_freq" value="ê°€ë” ì‚¬ìš©(2)" /><span>ê°€ë” ì‚¬ìš©(2)</span></label>
              <label class="option"><input type="radio" name="B3_emoji_freq" value="ë³´í†µ(3)" /><span>ë³´í†µ(3)</span></label>
              <label class="option"><input type="radio" name="B3_emoji_freq" value="ìì£¼ ì‚¬ìš©(4)" /><span>ìì£¼ ì‚¬ìš©(4)</span></label>
              <label class="option"><input type="radio" name="B3_emoji_freq" value="ë§¤ìš° ìì£¼ ì‚¬ìš©(5)" /><span>ë§¤ìš° ìì£¼ ì‚¬ìš©(5)</span></label>
            </div>
          </div>

          <div class="question-block">
            <div class="question-title">B4. êµ¬ë§¤í•œ ì¹´ì¹´ì˜¤í†¡ ì´ëª¨í‹°ì½˜ ê°œìˆ˜</div>
            <div class="options">
              <label class="option"><input type="radio" name="B4_emoji_count" value="ì—†ìŒ(1)" /><span>ì—†ìŒ(1)</span></label>
              <label class="option"><input type="radio" name="B4_emoji_count" value="1~3ê°œ(2)" /><span>1~3ê°œ(2)</span></label>
              <label class="option"><input type="radio" name="B4_emoji_count" value="4~10ê°œ(3)" /><span>4~10ê°œ(3)</span></label>
              <label class="option"><input type="radio" name="B4_emoji_count" value="11~20ê°œ(4)" /><span>11~20ê°œ(4)</span></label>
              <label class="option"><input type="radio" name="B4_emoji_count" value="21ê°œ ì´ìƒ(5)" /><span>21ê°œ ì´ìƒ(5)</span></label>
            </div>
          </div>

          <div class="question-block">
            <div class="question-title">B5. ì£¼ë¡œ ì–´ë–¤ ìƒí™©ì—ì„œ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•˜ëŠ”ê°€? (ë³µìˆ˜ ì„ íƒ)</div>
            <div class="options">
              <label class="option"><input type="checkbox" name="B5_emoji_situations" value="ê°ì •ì„ í‘œí˜„í•  ë•Œ" /> <span>ê°ì •ì„ í‘œí˜„í•  ë•Œ</span></label>
              <label class="option"><input type="checkbox" name="B5_emoji_situations" value="ëŒ€í™” ë¶„ìœ„ê¸°ë¥¼ ë¶€ë“œëŸ½ê²Œ í•  ë•Œ" /> <span>ëŒ€í™” ë¶„ìœ„ê¸°ë¥¼ ë¶€ë“œëŸ½ê²Œ í•  ë•Œ</span></label>
              <label class="option"><input type="checkbox" name="B5_emoji_situations" value="ë§ë¡œ í‘œí˜„í•˜ê¸° ì–´ë ¤ìš´ ê°ì •ì¼ ë•Œ" /> <span>ë§ë¡œ í‘œí˜„í•˜ê¸° ì–´ë ¤ìš´ ê°ì •ì¼ ë•Œ</span></label>
              <label class="option"><input type="checkbox" name="B5_emoji_situations" value="ì¬ë¯¸ë¥¼ ìœ„í•´" /> <span>ì¬ë¯¸ë¥¼ ìœ„í•´</span></label>
              <label class="option"><input type="checkbox" name="B5_emoji_situations" value="ëŒ€í™”ë¥¼ ë§ˆë¬´ë¦¬í•  ë•Œ" /> <span>ëŒ€í™”ë¥¼ ë§ˆë¬´ë¦¬í•  ë•Œ</span></label>
              <label class="option"><input type="checkbox" name="B5_emoji_situations" value="ìƒëŒ€ë°©ì—ê²Œ ê³µê°ì„ í‘œì‹œí•  ë•Œ" /> <span>ìƒëŒ€ë°©ì—ê²Œ ê³µê°ì„ í‘œì‹œí•  ë•Œ</span></label>
              <label class="option"><input type="checkbox" name="B5_emoji_situations" value="ê¸°íƒ€" /> <span>ê¸°íƒ€</span></label>
            </div>
            <div class="question-desc" style="margin-top:10px;">(ì„ íƒ) ê¸°íƒ€ ì„ íƒ ì‹œ ì‘ì„±í•´ ì£¼ì„¸ìš”.</div>
            <textarea name="B5_other" placeholder=""></textarea>
          </div>

          <div class="question-block">
            <div class="question-title">B6. ì¹´ì¹´ì˜¤í†¡ ì™¸ì— ìì£¼ ì‚¬ìš©í•˜ëŠ” ë©”ì‹ ì € ì•± (ë³µìˆ˜ ì„ íƒ)</div>
            <div class="options">
              <label class="option"><input type="checkbox" name="B6_other_messengers" value="WhatsApp" /> <span>WhatsApp</span></label>
              <label class="option"><input type="checkbox" name="B6_other_messengers" value="Telegram" /> <span>Telegram</span></label>
              <label class="option"><input type="checkbox" name="B6_other_messengers" value="iMessage" /> <span>iMessage</span></label>
              <label class="option"><input type="checkbox" name="B6_other_messengers" value="WeChat" /> <span>WeChat</span></label>
              <label class="option"><input type="checkbox" name="B6_other_messengers" value="LINE" /> <span>LINE</span></label>
              <label class="option"><input type="checkbox" name="B6_other_messengers" value="Instagram DM" /> <span>Instagram DM</span></label>
              <label class="option"><input type="checkbox" name="B6_other_messengers" value="ê¸°íƒ€" /> <span>ê¸°íƒ€</span></label>
            </div>
            <div class="question-desc" style="margin-top:10px;">(ì„ íƒ) ê¸°íƒ€ ì„ íƒ ì‹œ ì‘ì„±í•´ ì£¼ì„¸ìš”.</div>
            <textarea name="B6_other" placeholder="ê¸°íƒ€ ë©”ì‹ ì €(ì„ íƒ)"></textarea>
          </div>

          <div class="question-block">
            <div class="question-title">B7. ì¹´ì¹´ì˜¤í†¡ ì´ëª¨í‹°ì½˜ì´ ë‹¤ë¥¸ ë©”ì‹ ì € ì´ëª¨í‹°ì½˜ê³¼ ë‹¤ë¥´ë‹¤ë©´, ì–´ë–¤ ì ì´ ë‹¤ë¥¸ì§€ ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”.</div>
            <textarea name="B7_detail" placeholder=""></textarea>
          </div>

          <div class="buttons buttons-right">
            <button type="button" class="btn btn-primary" id="to-step2">ë‹¤ìŒ â–¶</button>
          </div>
        </section>

        <!-- ======================================================
             [PAGE 2] STEP2 - PART C
        ======================================================= -->
        <section id="step2" class="step">
          <div class="session-title">PAGE 2. PART C ê°œì¸/ì§‘ë‹¨ì£¼ì˜ ì²™ë„</div>
          <div class="session-subtitle">1 ~ 9 (ëœë¤ ì œì‹œ)</div>

          <div id="partC-container"></div>
          <div class="error-toast" id="error-step2"></div>

          <div class="buttons">
            <button type="button" class="btn btn-secondary" id="back-to-step1">â—€ ì´ì „</button>
            <button type="button" class="btn btn-primary" id="to-step3">ë‹¤ìŒ â–¶</button>
          </div>
        </section>

        <!-- ======================================================
             [PAGE 3] STEP3 - PART D-1
        ======================================================= -->
        <section id="step3" class="step">
          <div class="session-title">PAGE 3. PART D-1 ì´ëª¨í‹°ì½˜ ì£¼ê´€ì  ê°ì • ì¸ì‹</div>
          <div class="session-subtitle">ì•„ë˜ 12ê°œ ì´ëª¨í‹°ì½˜ ê°ê°ì— ëŒ€í•´, ì–´ë–¤ ê°ì •ì„ í‘œí˜„í•œë‹¤ê³  ìƒê°í•˜ëŠ”ì§€ ì ì–´ ì£¼ì„¸ìš”. (ëœë¤ ì œì‹œ)</div>

          <div id="partD1-container"></div>

          <div class="error-toast" id="error-step3"></div>

          <div class="buttons">
            <button type="button" class="btn btn-secondary" id="back-to-step2">â—€ ì´ì „</button>
            <button type="button" class="btn btn-primary" id="to-step4">ë‹¤ìŒ â–¶</button>
          </div>
        </section>

        <!-- ======================================================
             [PAGE 4] STEP4 - PART D-2
        ======================================================= -->
        <section id="step4" class="step">
          <div class="session-title">PAGE 4. PART D-2 ì´ëª¨í‹°ì½˜ ì •ì„œ íŒë‹¨ ë° ì´í•´ë„</div>
          <div class="session-subtitle">
            PAGE3ê³¼ ë™ì¼í•œ ì´ëª¨í‹°ì½˜(ë™ì¼ ìˆœì„œ)ì…ë‹ˆë‹¤. ê° ì´ëª¨í‹°ì½˜ì— ëŒ€í•´ ëª¨ë“  ë¬¸í•­ì„ ì‘ë‹µí•´ ì£¼ì„¸ìš”.
          </div>

          <div id="partD2-container"></div>

          <div class="error-toast" id="error-step4"></div>

          <div class="buttons">
            <button type="button" class="btn btn-secondary" id="back-to-step3">â—€ ì´ì „</button>
            <button type="button" class="btn btn-primary" id="to-step5">ë‹¤ìŒ â–¶</button>
          </div>
        </section>

        <!-- ======================================================
             [PAGE 5] STEP5 - PART E
        ======================================================= -->
        <section id="step5" class="step">
          <div class="session-title">PAGE 5. PART E ì´ëª¨í‹°ì½˜ í‘œí˜„ ë° ìˆ˜ìš©ì„± ì²™ë„</div>
          <div class="session-subtitle">1 ~ 9 (ëœë¤ ì œì‹œ)</div>

          <div id="partE-container"></div>

          <div class="error-toast" id="error-step5"></div>

          <div class="buttons">
            <button type="button" class="btn btn-secondary" id="back-to-step4">â—€ ì´ì „</button>
            <button type="submit" class="btn btn-primary">ì‘ë‹µ ì œì¶œí•˜ê¸°</button>
          </div>
        </section>
      </form>

      <div id="thank-you">
        <h2>ì‘ë‹µí•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ˜Š</h2>
        <p>
          ì„¤ë¬¸ ì‘ë‹µì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.<br />
          (ì „ì†¡ í›„ ì´ í˜ì´ì§€ê°€ ì™„ë£Œ í™”ë©´ìœ¼ë¡œ ì „í™˜ë©ë‹ˆë‹¤.)
        </p>
      </div>

    </div>
  </div>

<script>
  // ======================================================
  // âœ… [JS-0] Apps Script(Web App) ì—°ë™ ì„¤ì • (ë„ˆê°€ ì¤€ ìµœì‹  URL)
  // ======================================================
  const API_URL =
    "https://script.google.com/macros/s/AKfycbwfVVOGRE9dTPOOMfFm6r5PtbhrsruievXhszKFdwhbX6hFa08XndQqWMtYaTqfqtsDnA/exec";

  // ======================================================
  // [JS-1] shuffle
  // ======================================================
  function shuffle(array) {
    const arr = array.slice();
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  // ======================================================
  // [JS-2] Likert ë Œë”ëŸ¬ (í•„ìˆ˜ ì œê±° -> required=falseë¡œ ì‚¬ìš©)
  // ======================================================
  function renderLikert(name, min, max) {
    const vals = [];
    for (let v = min; v <= max; v++) vals.push(v);
    return `
      <div class="likert-row">
        ${vals.map((v) => `
          <label class="likert-item">
            <input type="radio" name="${name}" value="${v}" />
            <span class="emotion-dot"></span>
            <span class="likert-number">${v}</span>
          </label>
        `).join("")}
      </div>
    `;
  }

  // ======================================================
  // âœ… [JS-3] í˜ì´ì§€ ê²€ì¦ ë¡œì§: í•„ìˆ˜ ì œê±° -> í•­ìƒ true
  // ======================================================
  function validateStep() { return true; }

  // ======================================================
  // âœ… [JS-4] Apps Scriptë¡œ ì „ì†¡ (no-cors + urlencoded)
  // ======================================================
  async function submitToSheet(formEl) {
    const fd = new FormData(formEl);
    fd.append("_submitted_at", new Date().toISOString());

    const payload = new URLSearchParams();
    for (const [k, v] of fd.entries()) payload.append(k, v);

    await fetch(API_URL, {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8" },
      body: payload.toString(),
    });
  }

  // ======================================================
  // [JS-5] DOMContentLoaded
  // ======================================================
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("survey-form");
    const thank = document.getElementById("thank-you");

    const step1 = document.getElementById("step1");
    const step2 = document.getElementById("step2");
    const step3 = document.getElementById("step3");
    const step4 = document.getElementById("step4");
    const step5 = document.getElementById("step5");

    function showStep(n) {
      [step1, step2, step3, step4, step5].forEach((el, idx) => {
        if (idx === n - 1) el.classList.add("step-active");
        else el.classList.remove("step-active");
      });
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    // -------------------------
    // [JS-5A] PART C ëœë¤ ë Œë”ë§
    // -------------------------
    const partCItems = [
      { code: "C_HC_1", text: "ë‚´ í–‰ë³µì€ ì£¼ë³€ ì‚¬ëŒë“¤ì˜ í–‰ë³µì— í° ì˜í–¥ì„ ë°›ëŠ”ë‹¤. (HC)" },
      { code: "C_HC_2", text: "ë™ë£Œë“¤ì˜ í–‰ë³µì´ ë‚˜ì—ê²Œ ì¤‘ìš”í•˜ë‹¤. (HC)" },
      { code: "C_HC_3", text: "ë™ë£Œê°€ ìƒì„ ë°›ìœ¼ë©´ ë‚˜ë„ ìë‘ìŠ¤ëŸ¬ìš¸ ê²ƒì´ë‹¤. (HC)" },
      { code: "C_HC_4", text: "ë‚˜ëŠ” ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ í˜‘ë™í•  ë•Œ ê¸°ë¶„ì´ ì¢‹ë‹¤. (HC)" },

      { code: "C_VC_1", text: "ë‚˜ëŠ” ë§¤ìš° ì‹«ì–´í•˜ëŠ” ì¼ì´ë¼ë„ ê°€ì¡±ì„ ê¸°ì˜ê²Œ í•˜ëŠ” ì¼ì´ë¼ë©´ í•˜ê² ë‹¤. (VC)" },
      { code: "C_VC_2", text: "ë‚˜ëŠ” ì§‘ë‹¨ì˜ ì´ìµì„ ìœ„í•´ ë‚´ ê°œì¸ì ì¸ ì´ìµì„ í¬ìƒí•œë‹¤. (VC)" },
      { code: "C_VC_3", text: "ìì‹ì€ ë¶€ëª¨ë‹˜ì´ í›Œë¥­í•œ ìƒì„ ë°›ìœ¼ì‹œë©´ ì˜ê´‘ìŠ¤ëŸ½ê²Œ ìƒê°í•´ì•¼ í•œë‹¤. (VC)" },
      { code: "C_VC_4", text: "ë‚´ê°€ ì•„ë¬´ë¦¬ ì¢‹ì•„í•˜ëŠ” ì¼ì´ë¼ë„ ê°€ì¡±ì´ ë°˜ëŒ€í•˜ë©´ í¬ê¸°í•œë‹¤. (VC)" },

      { code: "C_HI_1", text: "ë‚˜ëŠ” ë‚¨ë“¤ê³¼ ë‹¤ë¥¸ ë‚˜ì˜ ê°œì„±ìˆëŠ” ëª¨ìŠµì„ ì¢‹ì•„í•œë‹¤. (HI)" },
      { code: "C_HI_2", text: "ë‚˜ëŠ” ì¢…ì¢… ë‚˜ë§Œì˜ ë°©ì‹ëŒ€ë¡œ í–‰ë™í•œë‹¤. (HI)" },
      { code: "C_HI_3", text: "ë‚˜ëŠ” ê°œì„±ì´ ëšœë ·í•œ ì‚¬ëŒì´ë‹¤. (HI)" },

      { code: "C_VI_1", text: "ë‚˜ëŠ” ë‚¨ë“¤ê³¼ ê²½ìŸí•˜ëŠ” í™˜ê²½ì—ì„œ ì¼í•˜ëŠ” ê²ƒì„ ì¦ê¸´ë‹¤. (VI)" },
      { code: "C_VI_2", text: "ê²½ìŸì€ ìì—°ì˜ ë²•ì¹™ì´ë‹¤. (VI)" },
      { code: "C_VI_3", text: "ê²½ìŸ ì—†ì´ëŠ” ì¢‹ì€ ì‚¬íšŒë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤. (VI)" },
    ];

    const partCContainer = document.getElementById("partC-container");
    shuffle(partCItems).forEach((it, idx) => {
      const block = document.createElement("div");
      block.className = "question-block";
      block.innerHTML = `
        <div class="question-title">
          C-${idx + 1}. ${it.text}
        </div>
        <div class="question-desc">1 ~ 9</div>
        ${renderLikert(it.code, 1, 9)}
      `;
      partCContainer.appendChild(block);
    });

    // -------------------------
    // [JS-5B] PART D-1 / D-2 ì´ëª¨í‹°ì½˜ ëœë¤ (ë™ì¼ ìˆœì„œ ìœ ì§€)
    // -------------------------
    const emojiFiles = [
      "emoji01.png","emoji02.png","emoji03.png","emoji04.png",
      "emoji05.png","emoji06.png","emoji07.png","emoji08.png",
      "emoji09.png","emoji10.png","emoji11.png","emoji12.png"
    ];
    const emojiOrder = shuffle(emojiFiles);

    const orderInput = document.createElement("input");
    orderInput.type = "hidden";
    orderInput.name = "emoji_order";
    orderInput.value = emojiOrder.join(",");
    form.appendChild(orderInput);

    // D-1
    const d1 = document.getElementById("partD1-container");
    emojiOrder.forEach((file, idx) => {
      const i = idx + 1;
      const block = document.createElement("div");
      block.className = "question-block white";
      block.innerHTML = `
        <div class="emoji-inline">
          <img src="${file}" alt="ì´ëª¨í‹°ì½˜ ${i}" />
        </div>
        <div class="question-title">
          D-1-${i}. ì´ ì´ëª¨í‹°ì½˜ì€ ì–´ë–¤ ê°ì •ì„ í‘œí˜„í•˜ê³  ìˆë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?
        </div>
        <textarea name="D1_label_${i}"></textarea>
        <input type="hidden" name="D1_emoji_${i}" value="${file}">
        <input type="hidden" name="D1_order_${i}" value="${i}">
      `;
      d1.appendChild(block);
    });

    // D-2
    const d2 = document.getElementById("partD2-container");
    const RANDOMIZE_BASIC_EMOTIONS = false;
    const baseEmotions = ["ê¸°ì¨","ìŠ¬í””","í™”ë‚¨","ë†€ë¼ì›€","ë‘ë ¤ì›€","í˜ì˜¤"];

    emojiOrder.forEach((file, idx) => {
      const i = idx + 1;
      const wrap = document.createElement("div");
      wrap.className = "emoji-block";

      const emoList = RANDOMIZE_BASIC_EMOTIONS ? shuffle(baseEmotions) : baseEmotions;

      wrap.innerHTML = `
        <div class="sticky-emoji-wrapper">
          <div class="emoji-top-box">
            <img src="${file}" alt="ì´ëª¨í‹°ì½˜ ${i}" />
          </div>
        </div>

        <div class="question-block">
          <div class="question-title">
            D-2-${i}-1. ì´ ì´ëª¨í‹°ì½˜ì˜ ì „ë°˜ì ì¸ ì •ì„œë¥¼ í‰ê°€í•´ ì£¼ì„¸ìš”.
          </div>
          <div class="question-desc">ê° í•­ëª©ì— ëŒ€í•´ 1~7 ì‚¬ì´ì—ì„œ ì„ íƒí•´ ì£¼ì„¸ìš”.</div>

          <div class="question-desc" style="margin-top:4px; margin-bottom:4px;">
            (A) ê¸ì • ì •ì„œ: 1(ì „í˜€ ì—†ìŒ) ~ 7(ë§¤ìš° ê¸ì •)
          </div>
          ${renderLikert(`D2_pos_${i}`, 1, 7)}

          <div class="question-desc" style="margin-top:10px; margin-bottom:4px;">
            (B) ë¶€ì • ì •ì„œ: 1(ì „í˜€ ì—†ìŒ) ~ 7(ë§¤ìš° ë¶€ì •)
          </div>
          ${renderLikert(`D2_neg_${i}`, 1, 7)}

          <div class="question-desc" style="margin-top:10px; margin-bottom:4px;">
            (C) ê°ì„± ìˆ˜ì¤€: 1(ë§¤ìš° ì°¨ë¶„) ~ 7(ë§¤ìš° ê°ì„±)
          </div>
          ${renderLikert(`D2_arousal_${i}`, 1, 7)}
        </div>

        <div class="question-block">
          <div class="question-title">
            D-2-${i}-2. ì´ ì´ëª¨í‹°ì½˜ì´ ë‹¤ìŒ ê°ì •ì„ ì–¼ë§ˆë‚˜ í‘œí˜„í•œë‹¤ê³  ëŠë¼ì‹­ë‹ˆê¹Œ?
          </div>
          <div class="question-desc">0 = ì „í˜€ ëŠê»´ì§€ì§€ ì•ŠëŠ”ë‹¤ ~ 7 = ë§¤ìš° ê°•í•˜ê²Œ ëŠê»´ì§„ë‹¤</div>

          <div class="emotion-table">
            <div class="emotion-row" style="background: transparent;">
              <div></div>
              ${[0,1,2,3,4,5,6,7].map(v => `<div class="row-center">${v}</div>`).join("")}
            </div>

            ${emoList.map((emo) => `
              <div class="emotion-row">
                <div class="emotion-label">${emo}</div>
                ${[0,1,2,3,4,5,6,7].map((v) => `
                  <label class="row-center">
                    <input type="radio" name="D2_${emo}_${i}" value="${v}" />
                    <span class="emotion-dot"></span>
                  </label>
                `).join("")}
              </div>
            `).join("")}
          </div>
        </div>

        <div class="question-block">
          <div class="question-title">
            D-2-${i}-3. ì´ ì´ëª¨í‹°ì½˜ì—ì„œ ë‘ ê°€ì§€ ì´ìƒì˜ ê°ì •ì´ ë™ì‹œì— ëŠê»´ì¡Œë‚˜ìš”?
          </div>
          <div class="options">
            <label class="option"><input type="radio" name="D2_multi_${i}" value="ì˜ˆ" /> <span>ì˜ˆ</span></label>
            <label class="option"><input type="radio" name="D2_multi_${i}" value="ì•„ë‹ˆì˜¤" /> <span>ì•„ë‹ˆì˜¤</span></label>
          </div>
        </div>

        <div class="question-block">
          <div class="question-title">
            D-2-${i}-4. ì´ ì´ëª¨í‹°ì½˜ì˜ ì˜ë¯¸ë¥¼ ì´í•´í•˜ëŠ” ë° ì–´ë ¤ì›€ì´ ìˆì—ˆë‚˜ìš”?
          </div>
          <div class="question-desc">1 = ì „í˜€ ì–´ë µì§€ ì•Šì•˜ë‹¤ ~ 7 = ë§¤ìš° ì–´ë ¤ì› ë‹¤</div>
          ${renderLikert(`D2_difficulty_${i}`, 1, 7)}
        </div>

        <div class="question-block">
          <div class="question-title">
            D-2-${i}-5. ì´ ì´ëª¨í‹°ì½˜ì´ í‘œí˜„í•˜ëŠ” ê°ì •ì´ ëª…í™•í•˜ë‹¤ê³  ëŠë¼ì…¨ë‚˜ìš”?
          </div>
          <div class="question-desc">1 = ì „í˜€ ëª…í™•í•˜ì§€ ì•Šë‹¤ ~ 7 = ë§¤ìš° ëª…í™•í•˜ë‹¤</div>
          ${renderLikert(`D2_clarity_${i}`, 1, 7)}
        </div>

        <div class="question-block">
          <div class="question-title">
            D-2-${i}-6. ì´ ì´ëª¨í‹°ì½˜ì„ ëˆ„êµ¬ì—ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ê³  ìƒê°í•˜ë‚˜ìš”? (ë³µìˆ˜ ì„ íƒ)
          </div>
          <div class="options">
            <label class="option"><input type="checkbox" name="D2_target_${i}" value="ë¶€ëª¨ë‹˜" /> <span>ë¶€ëª¨ë‹˜</span></label>
            <label class="option"><input type="checkbox" name="D2_target_${i}" value="ìœ—ì‚¬ëŒ" /> <span>ìœ—ì‚¬ëŒ(ì§ì¥ ìƒì‚¬/êµìˆ˜ë‹˜ ë“±)</span></label>
            <label class="option"><input type="checkbox" name="D2_target_${i}" value="ì¹œêµ¬" /> <span>ì¹œêµ¬</span></label>
            <label class="option"><input type="checkbox" name="D2_target_${i}" value="ì•„ë«ì‚¬ëŒ" /> <span>ì•„ë«ì‚¬ëŒ(í›„ë°°/ë™ìƒ)</span></label>
            <label class="option"><input type="checkbox" name="D2_target_${i}" value="ëª¨ë¥´ëŠ” ì‚¬ëŒ/ì˜¨ë¼ì¸ ìƒëŒ€" /> <span>ëª¨ë¥´ëŠ” ì‚¬ëŒ/ì˜¨ë¼ì¸ ìƒëŒ€</span></label>
            <label class="option"><input type="checkbox" name="D2_target_${i}" value="ëˆ„êµ¬ì—ê²Œë‚˜ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤" /> <span>ëˆ„êµ¬ì—ê²Œë‚˜ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤</span></label>
          </div>
        </div>

        <input type="hidden" name="D2_emoji_${i}" value="${file}">
        <input type="hidden" name="D2_order_${i}" value="${i}">
      `;
      d2.appendChild(wrap);
    });

    // -------------------------
    // [JS-5C] PART E ëœë¤ ë Œë”ë§
    // -------------------------
    const partEItems = [
      { code: "E_PubNeg_1", text: "ê³µì ì¸ ëŒ€í™”ì—ì„œ ë‚´ê°€ ë¶€ì •ì ì¸ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ê´œì°®ë‹¤. (PublicÃ—Negative)" },
      { code: "E_PubNeg_2R", text: "ê³µì ì¸ ëŒ€í™”ì—ì„œ ë‚˜ëŠ” ë¶€ì •ì ì¸ ì´ëª¨í‹°ì½˜ìœ¼ë¡œ ê°ì •ì„ í‘œí˜„í•˜ê¸° ì–´ë µë‹¤. (R) (PublicÃ—Negative)" },
      { code: "E_PubNeg_3", text: "ê³µì ì¸ ëŒ€í™”ì—ì„œ ìƒëŒ€ê°€ ë¶€ì •ì ì¸ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ê´œì°®ë‹¤. (PublicÃ—Negative)" },
      { code: "E_PubNeg_4R", text: "ê³µì ì¸ ëŒ€í™”ì—ì„œ ìƒëŒ€ê°€ ì‚¬ìš©í•˜ëŠ” ë¶€ì •ì ì¸ ì´ëª¨í‹°ì½˜ì€ ì¢…ì¢… ì´í•´í•˜ê¸° ì–´ë µë‹¤. (R) (PublicÃ—Negative)" },

      { code: "E_PriNeg_1", text: "ì‚¬ì ì¸ ëŒ€í™”ì—ì„œ ë‚´ê°€ ë¶€ì •ì ì¸ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ê´œì°®ë‹¤. (PrivateÃ—Negative)" },
      { code: "E_PriNeg_2R", text: "ì‚¬ì ì¸ ëŒ€í™”ì—ì„œ ë‚˜ëŠ” ë¶€ì •ì ì¸ ì´ëª¨í‹°ì½˜ìœ¼ë¡œ ê°ì •ì„ í‘œí˜„í•˜ê¸° ì–´ë µë‹¤. (R) (PrivateÃ—Negative)" },
      { code: "E_PriNeg_3", text: "ì‚¬ì ì¸ ëŒ€í™”ì—ì„œ ìƒëŒ€ê°€ ë¶€ì •ì ì¸ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ê´œì°®ë‹¤. (PrivateÃ—Negative)" },
      { code: "E_PriNeg_4R", text: "ì‚¬ì ì¸ ëŒ€í™”ì—ì„œ ìƒëŒ€ê°€ ì‚¬ìš©í•˜ëŠ” ë¶€ì •ì ì¸ ì´ëª¨í‹°ì½˜ì€ ì¢…ì¢… ì´í•´í•˜ê¸° ì–´ë µë‹¤. (R) (PrivateÃ—Negative)" },

      { code: "E_PubPos_1", text: "ê³µì ì¸ ëŒ€í™”ì—ì„œ ë‚´ê°€ ê¸ì •ì ì¸ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ê´œì°®ë‹¤. (PublicÃ—Positive)" },
      { code: "E_PubPos_2R", text: "ê³µì ì¸ ëŒ€í™”ì—ì„œ ë‚˜ëŠ” ê¸ì •ì ì¸ ì´ëª¨í‹°ì½˜ìœ¼ë¡œ ê°ì •ì„ í‘œí˜„í•˜ê¸° ì–´ë µë‹¤. (R) (PublicÃ—Positive)" },
      { code: "E_PubPos_3", text: "ê³µì ì¸ ëŒ€í™”ì—ì„œ ìƒëŒ€ê°€ ê¸ì •ì ì¸ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ê´œì°®ë‹¤. (PublicÃ—Positive)" },
      { code: "E_PubPos_4R", text: "ê³µì ì¸ ëŒ€í™”ì—ì„œ ìƒëŒ€ê°€ ì‚¬ìš©í•˜ëŠ” ê¸ì •ì ì¸ ì´ëª¨í‹°ì½˜ì€ ì¢…ì¢… ì´í•´í•˜ê¸° ì–´ë µë‹¤. (R) (PublicÃ—Positive)" },

      { code: "E_PriPos_1", text: "ì‚¬ì ì¸ ëŒ€í™”ì—ì„œ ë‚´ê°€ ê¸ì •ì ì¸ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ê´œì°®ë‹¤. (PrivateÃ—Positive)" },
      { code: "E_PriPos_2R", text: "ì‚¬ì ì¸ ëŒ€í™”ì—ì„œ ë‚˜ëŠ” ê¸ì •ì ì¸ ì´ëª¨í‹°ì½˜ìœ¼ë¡œ ê°ì •ì„ í‘œí˜„í•˜ê¸° ì–´ë µë‹¤. (R) (PrivateÃ—Positive)" },
      { code: "E_PriPos_3", text: "ì‚¬ì ì¸ ëŒ€í™”ì—ì„œ ìƒëŒ€ê°€ ê¸ì •ì ì¸ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ê´œì°®ë‹¤. (PrivateÃ—Positive)" },
      { code: "E_PriPos_4R", text: "ì‚¬ì ì¸ ëŒ€í™”ì—ì„œ ìƒëŒ€ê°€ ì‚¬ìš©í•˜ëŠ” ê¸ì •ì ì¸ ì´ëª¨í‹°ì½˜ì€ ì¢…ì¢… ì´í•´í•˜ê¸° ì–´ë µë‹¤. (R) (PrivateÃ—Positive)" },
    ];

    const partEContainer = document.getElementById("partE-container");
    shuffle(partEItems).forEach((it, idx) => {
      const block = document.createElement("div");
      block.className = "question-block";
      block.innerHTML = `
        <div class="question-title">
          E-${idx + 1}. ${it.text}
        </div>
        <div class="question-desc">1 ~ 9</div>
        ${renderLikert(it.code, 1, 9)}
      `;
      partEContainer.appendChild(block);
    });

    // -------------------------
    // [JS-5D] í˜ì´ì§€ ì´ë™
    // -------------------------
    document.getElementById("to-step2").addEventListener("click", () => {
      if (validateStep()) showStep(2);
    });
    document.getElementById("back-to-step1").addEventListener("click", () => showStep(1));

    document.getElementById("to-step3").addEventListener("click", () => {
      if (validateStep()) showStep(3);
    });
    document.getElementById("back-to-step2").addEventListener("click", () => showStep(2));

    document.getElementById("to-step4").addEventListener("click", () => {
      if (validateStep()) showStep(4);
    });
    document.getElementById("back-to-step3").addEventListener("click", () => showStep(3));

    document.getElementById("to-step5").addEventListener("click", () => {
      if (validateStep()) showStep(5);
    });
    document.getElementById("back-to-step4").addEventListener("click", () => showStep(4));

    // -------------------------
    // âœ… [JS-5E] ìµœì¢… ì œì¶œ (Apps Script ì „ì†¡)
    // -------------------------
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      try {
        await submitToSheet(form);
        form.style.display = "none";
        thank.style.display = "block";
        window.scrollTo({ top: 0, behavior: "smooth" });
      } catch (err) {
        console.error(err);
        alert("ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
      }
    });
  });
</script>
</body>
</html>

